<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>專業產能計算工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f8fafc;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .app-container {
            max-width: 480px;
            margin: 0 auto;
        }
        input[type="datetime-local"], input[type="number"] {
            font-size: 16px !important; /* 防止 iOS 自動放大 */
        }
        .btn-active:active {
            transform: scale(0.96);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="app-container">
        <!-- 標題 -->
        <div class="mb-8 text-center">
            <h1 class="text-3xl font-black text-slate-900 tracking-tight">產能效率計算</h1>
            <p class="text-slate-500 mt-2 font-medium">精確至秒 ‧ 自動分析 ‧ 隨時分享</p>
        </div>

        <div class="bg-white rounded-[2rem] shadow-xl shadow-slate-200/60 p-6 border border-slate-100">
            <div class="space-y-6">
                <!-- 時間選取 -->
                <div class="grid grid-cols-1 gap-4">
                    <div class="relative">
                        <label class="text-[11px] font-bold text-slate-400 ml-2 mb-1 block uppercase tracking-wider">開始時間</label>
                        <input type="datetime-local" id="startTime" step="1" 
                               class="w-full p-4 bg-slate-50 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none transition-all font-medium text-slate-700">
                    </div>
                    <div class="relative">
                        <label class="text-[11px] font-bold text-slate-400 ml-2 mb-1 block uppercase tracking-wider">結束時間</label>
                        <input type="datetime-local" id="endTime" step="1"
                               class="w-full p-4 bg-slate-50 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none transition-all font-medium text-slate-700">
                    </div>
                </div>

                <!-- 包裹數量 -->
                <div class="relative">
                    <label class="text-[11px] font-bold text-slate-400 ml-2 mb-1 block uppercase tracking-wider">包裹總數</label>
                    <input type="number" id="packageCount" placeholder="輸入處理件數..." inputmode="numeric"
                           class="w-full p-4 bg-slate-50 border-2 border-transparent focus:border-blue-500 rounded-2xl outline-none transition-all font-medium text-slate-700">
                </div>

                <!-- 計算按鈕 -->
                <button onclick="performCalculation()" 
                        class="btn-active w-full bg-slate-900 hover:bg-black text-white font-bold py-5 rounded-2xl transition-all shadow-lg shadow-slate-300 text-lg">
                    產出分析報告
                </button>

                <!-- 結果區 -->
                <div id="resultArea" class="hidden space-y-4 animate-in fade-in slide-in-from-bottom-2">
                    <!-- 時間報告 -->
                    <div class="bg-indigo-50 p-5 rounded-2xl border border-indigo-100">
                        <p class="text-indigo-400 text-[10px] font-black uppercase tracking-widest mb-2">時長分析</p>
                        <div id="displayTime" class="text-xl font-bold text-indigo-900"></div>
                        <div class="mt-2 text-xs text-indigo-400">總計：<span id="displayTotalSec" class="font-mono font-bold"></span> 秒</div>
                    </div>

                    <!-- 效率報告 -->
                    <div id="efficiencyCard" class="hidden bg-emerald-50 p-5 rounded-2xl border border-emerald-100">
                        <p class="text-emerald-400 text-[10px] font-black uppercase tracking-widest mb-1">平均產能</p>
                        <div id="displayAvg" class="text-2xl font-black text-emerald-700"></div>
                        <p class="text-[10px] text-emerald-400 mt-1">每處理一件所需的平均時間</p>
                    </div>

                    <!-- 分享按鈕 -->
                    <button onclick="copyToClipboard()" class="w-full py-3 text-slate-400 text-sm font-medium hover:text-slate-600 transition-colors">
                        複製報告文字
                    </button>
                </div>
            </div>
        </div>

        <p class="text-center mt-8 text-slate-300 text-[10px] font-medium tracking-widest uppercase">
            Professional Productivity System
        </p>
    </div>

    <!-- 提示框 -->
    <div id="toast" class="fixed bottom-10 left-1/2 -translate-x-1/2 bg-black text-white px-6 py-3 rounded-full text-sm font-bold opacity-0 transition-opacity pointer-events-none">
        已複製報告
    </div>

    <script>
        // 設定預設時間
        window.onload = () => {
            const now = new Date();
            const tzOffset = now.getTimezoneOffset() * 60000;
            const localTime = new Date(Date.now() - tzOffset).toISOString().slice(0, 19);
            document.getElementById('startTime').value = localTime;
            document.getElementById('endTime').value = localTime;
        };

        function performCalculation() {
            const start = new Date(document.getElementById('startTime').value);
            const end = new Date(document.getElementById('endTime').value);
            const count = parseInt(document.getElementById('packageCount').value);

            if (isNaN(start) || isNaN(end)) return;

            const totalSec = Math.abs(Math.floor((end - start) / 1000));
            const d = Math.floor(totalSec / 86400);
            const h = Math.floor((totalSec % 86400) / 3600);
            const m = Math.floor((totalSec % 3600) / 60);

            // 顯示結果區
            document.getElementById('resultArea').classList.remove('hidden');
            document.getElementById('displayTotalSec').innerText = totalSec.toLocaleString();

            let timeResult = "";
            if (d > 0) timeResult += `${d} 天 `;
            if (h > 0 || d > 0) timeResult += `${h} 小時 `;
            if (m > 0 || h > 0 || d > 0) timeResult += `${m} 分鐘 `;
            if (totalSec < 60) timeResult = "未滿 1 分鐘";
            document.getElementById('displayTime').innerText = timeResult;

            // 效率計算
            const effCard = document.getElementById('efficiencyCard');
            if (count > 0) {
                effCard.classList.remove('hidden');
                const avg = totalSec / count;
                document.getElementById('displayAvg').innerText = 
                    avg >= 60 ? `${Math.floor(avg/60)}分 ${(avg%60).toFixed(1)}秒` : `${avg.toFixed(2)} 秒`;
            } else {
                effCard.classList.add('hidden');
            }

            // 手機震動反饋
            if (navigator.vibrate) navigator.vibrate(40);
        }

        function copyToClipboard() {
            const time = document.getElementById('displayTime').innerText;
            const total = document.getElementById('displayTotalSec').innerText;
            const avg = document.getElementById('efficiencyCard').classList.contains('hidden') ? "" : `\n平均效率：${document.getElementById('displayAvg').innerText} / 件`;
            
            const text = `【產能報告】\n總時長：${time}\n總秒數：${total} 秒${avg}`;
            
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);

            const toast = document.getElementById('toast');
            toast.style.opacity = "1";
            setTimeout(() => toast.style.opacity = "0", 2000);
        }
    </script>
</body>
</html>

